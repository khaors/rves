---
title: "RVES Tutorial: Using R for the interpretation of Vertical Electrical Soundings"
author: 
  - name: Oscar Garcia-Cabrejo
    affiliation: Universidad Pedagogica y Tecnologica de Colombia
date: "`r Sys.Date()`"
lead_author_surname: Garcia-Cabrejo
abstract: |
  Random numbers following a Standard Normal distribution are of great
  importance when using simulations as a means for investigation. The Ziggurat
  method \citep{Marsaglia+Tsang:2000,Leong+Zhang+Lee+Luk+Villasenor:2005}
  is one of the fastest methods to generate normally distributed random
  numbers while also providing excellent statistical properties.
  This note provides an updated implementations of the Ziggurat generator
  suitable for 32- and 64-bit operating system. It compares the original
  implementations to several popular Open Source implementations. A new
  implementation embeds the generator into an appropriate C++ class
  structure. The performance of the different generator is investigated both
  via extended timing and through a series of statistical tests, including a
  suggested new test for testing Normal deviates directly. Integration
  into other systems such as R is discussed as well.

acknowledgements: |
  The initial implementations by John Burkardt were very helpful at the
  beginning of this project. Our suggestions of using portable types from the
  \code{stdint.h} header file for 32- and 64-bit use, as well as the need to
  reflect the insight of \cite{Leong+Zhang+Lee+Luk+Villasenor:2005} improved
  his version and our versions in a very fruitful email exchange which is
  gratefully acknowledged. Comments by Jochen Voss are also gratefully acknowledged.

footer_contents: "RcppZiggurat Vignette"

header-includes:
  \newcommand{\proglang}[1]{\textsf{#1}}
  \newcommand{\pkg}[1]{\textbf{#1}}
  \newcommand{\R}{\proglang{R}\ } 
  \newcommand{\Rns}{\proglang{R}} 
include-after: |
  \begin{thebibliography}{14}
  \newcommand{\enquote}[1]{``#1''}
  \providecommand{\natexlab}[1]{#1}
  \providecommand{\url}[1]{\texttt{#1}}
  \providecommand{\urlprefix}{URL }
  \expandafter\ifx\csname urlstyle\endcsname\relax
    \providecommand{\doi}[1]{doi:\discretionary{}{}{}#1}\else
    \providecommand{\doi}{doi:\discretionary{}{}{}\begingroup
    \urlstyle{rm}\Url}\fi
  \providecommand{\eprint}[2][]{\url{#2}}
  
  \bibitem[{Allaire \emph{et~al.}(2015)Allaire, Eddelbuettel, and
    Fran\c{c}ois}]{CRAN:Rcpp:Attributes}
  Allaire JJ, Eddelbuettel D, Fran\c{c}ois R (2015).
  \newblock \emph{{Rcpp} Attributes}.
  \newblock Vignette included in R package Rcpp,
    \urlprefix\url{http://CRAN.R-Project.org/package=Rcpp}.
  
  \bibitem[{Ametrano \emph{et~al.}(2015)Ametrano, Ballabio, Bianchetti,
    C\'{e}sar\'{e}, Eddelbuettel, Firth, Jean, Kenyon, Lichters, Marchioro,
    Spanderen, and Wang}]{Ametrano+Ballabio+et+al:QuantLib}
  Ametrano F, Ballabio L, Bianchetti M, C\'{e}sar\'{e} ND, Eddelbuettel D, Firth
    N, Jean N, Kenyon C, Lichters R, Marchioro M, Spanderen K, Wang J (2015).
  \newblock \enquote{QuantLib: A free/open-source library for quantitative
    finance.}
  \newblock Version 1.6., \urlprefix\url{http://quantlib.org/}.
  
  \bibitem[{Box and Muller(1958)}]{Box+Muller:1958}
  Box GEP, Muller ME (1958).
  \newblock \enquote{A Note on the Generation of Random Normal Deviates.}
  \newblock \emph{Annals of Mathematical Statistics}, \textbf{29}(2), 610--611.
  
  \bibitem[{Brown \emph{et~al.}(2013)Brown, Eddelbuettel, and
    Bauer}]{Brown+Eddelbuettel+Bauer:DieHarder}
  Brown RG, Eddelbuettel D, Bauer D (2013).
  \newblock \enquote{Dieharder: A Random Number Test Suite.}
  \newblock Open Source software library, under development,
    \urlprefix\url{http://www.phy.duke.edu/~rgb/General/dieharder.php}.
  
  \bibitem[{Cottrell and Lucchetti(2015)}]{Cottrell+Lucchetti:Gretl}
  Cottrell A, Lucchetti R (2015).
  \newblock \emph{Gretl User's Guide}.
  \newblock Version 1.10.1, \urlprefix\url{http://gretl.sourceforge.net/}.
  
  \bibitem[{Eddelbuettel(2013)}]{Eddelbuettel:2013:Rcpp}
  Eddelbuettel D (2013).
  \newblock \emph{Seamless R and C++ Integration with Rcpp}.
  \newblock Use R! Springer, New York.
  \newblock ISBN 978-1-4614-6867-7.
  
  \bibitem[{Eddelbuettel and Fran\c{c}ois(2015)}]{CRAN:Rcpp}
  Eddelbuettel D, Fran\c{c}ois R (2015).
  \newblock \emph{{Rcpp}: Seamless {R} and {C++} Integration}.
  \newblock R package version 0.12.0,
    \urlprefix\url{http://CRAN.R-Project.org/package=Rcpp}.
  
  \bibitem[{Galassi \emph{et~al.}(2013)Galassi, Davies, Theiler, Gough, Jungman,
    Alken, Booth, and Rossi}]{GSL}
  Galassi M, Davies J, Theiler J, Gough B, Jungman G, Alken P, Booth M, Rossi F
    (2013).
  \newblock \emph{{GNU} {S}cientific {L}ibrary {R}eference {M}anual}, 3rd
    edition.
  \newblock Version 1.16. {ISBN} 0954612078,
    \urlprefix\url{http://www.gnu.org/software/gsl}.
  
  \bibitem[{Leong \emph{et~al.}(2005)Leong, Zhang, Lee, Luk, and
    Villasenor}]{Leong+Zhang+Lee+Luk+Villasenor:2005}
  Leong PHW, Zhang G, Lee DU, Luk W, Villasenor J (2005).
  \newblock \enquote{A Comment on the Implementation of the Ziggurat Method.}
  \newblock \emph{Journal of Statistical Software}, \textbf{12}(7), 1--4.
  \newblock ISSN 1548-7660.
  \newblock \urlprefix\url{http://www.jstatsoft.org/v12/i07}.
  
  \bibitem[{Marsaglia and Tsang(2000)}]{Marsaglia+Tsang:2000}
  Marsaglia G, Tsang WW (2000).
  \newblock \enquote{The Ziggurat Method for Generating Random Variables.}
  \newblock \emph{Journal of Statistical Software}, \textbf{5}(8), 1--7.
  \newblock ISSN 1548-7660.
  \newblock \urlprefix\url{http://www.jstatsoft.org/v05/i08}.
  
  \bibitem[{Matsumoto and Nishimura(1998)}]{Matsumoto+Nishimura:1998}
  Matsumoto M, Nishimura T (1998).
  \newblock \enquote{Mersenne Twister: A 623-dimensionally Equidistributed
    Uniform Pseudo-random Number Generator.}
  \newblock \emph{ACM Transactions on Modeling and Computer Simulation (TOMACS)},
    \textbf{8}(1), 3--30.
  \newblock ISSN 1049-3301.
  \newblock \doi{10.1145/272991.272995}.
  \newblock \urlprefix\url{http://doi.acm.org/10.1145/272991.272995}.
  
  \bibitem[{Thomas \emph{et~al.}(2007)Thomas, Luk, Leong, and
    Villasenor}]{Thomas+Luk+Leong+Villasenor:2007}
  Thomas DB, Luk W, Leong PHW, Villasenor JD (2007).
  \newblock \enquote{Gaussian random number generators.}
  \newblock \emph{ACM Computing Surveys}, \textbf{39}(4), 11:1--11:38.
  
  \bibitem[{Voss(2011)}]{Voss:2011}
  Voss J (2011).
  \newblock \enquote{The Ziggurat Method for Generating Gaussian Random Numbers.}
  \newblock Webpage at \url{http://www.seehuhn.de/pages/ziggurat}.
  
  \bibitem[{Yalta and Schreiber(2012)}]{Yalta+Schreiber:2012}
  Yalta AT, Schreiber S (2012).
  \newblock \enquote{Random Number Generation in gretl.}
  \newblock \emph{Journal of Statistical Software, Code Snippets},
    \textbf{50}(1), 1--13.
  \newblock ISSN 1548-7660.
  \newblock \urlprefix\url{http://www.jstatsoft.org/v50/c01}.
  
  \end{thebibliography}
  
output: pinp::pinp

vignette: >
  %\VignetteIndexEntry{RVES Tutorial}
  %\VignetteKeywords{RVES, Vertical Electric Sounding, Convolution}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r setup, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

# Introduction

Generating random number for use in simulation is a classic topic in
scientific computing and about as old as the field itself. Most algorithms
concentrate on the uniform distribution. Its values can be used to generate
randomly distributed values from other distributions simply by using the
relevant inverse function.

Regarding terminology, all computational algorithms for generation
of \textsl{random} numbers are by definition deterministic. Here, we follow
standard convention and refer to such numbers as \textsl{pseudo-random} as
they can always be recreated given the seed value for a given sequence. We are not
concerned in this note with \textsl{quasi-random} numbers (also called
low-discrepnancy sequences). We consider this topic to be subset of
pseudo-random numbers subject to distributional constraints. Without lack of
generality, we will henceforth drop the qualifier \textsl{pseudo} when
refering to random numbers.
