<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Stepwise Estimation and Model selection of VES parameters using the rves package • rves</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Stepwise Estimation and Model selection of VES parameters using the rves package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rves</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rves-modelselection.html">Stepwise Estimation and Model selection of VES parameters using the rves package</a>
    </li>
    <li>
      <a href="../articles/rves-smoothing.html">VES Smoothing using the rves package</a>
    </li>
    <li>
      <a href="../articles/rves-transformation.html">Resistivity-Depth Transformations using the rves package</a>
    </li>
    <li>
      <a href="../articles/rves-tutorial.html">RVES Tutorial: Vertical Electrical Sounding interpretation using R</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Stepwise Estimation and Model selection of VES parameters using the rves package</h1>
                        <h4 class="author">Oscar Garcia-Cabrejo</h4>
            
            <h4 class="date">2018-05-08</h4>
      
      
      <div class="hidden name"><code>rves-modelselection.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>The Vertical Electrical Sounding (VES) is one of the oldest resistivity methods, and it is based on the measurements of the electrical apparent resistivity of the geological medium when the distance between the electrical source and the measurement nodes is increased. The main advantages of the VES include:</p>
<ul>
<li>low cost due to its minimal requirements for equipment and personal.</li>
<li>large investigation depth as required in some specific problems such as groundwater exploration.</li>
</ul>
<p>The main use of VES is to define an Earth model composed of different layers with defined electrical resistivies and thicknesses, but the main problem with this procedure is the objective definition of the <em>number of layers</em> to be used in this parameter estimation. This means that the <em>number of layers</em> can be considered as another parameter to be estimated but this makes the whole estimation approach more difficult. A simple strategy used since the early days is to identify the inflection points in the apparent resistivity curve and the number of these define the numbers of layers to be estimated. This approach is based on the geometrical characteristics of the geoelectrical response of simple layered models and, although. it is easy to apply, it lacks of a proper foundation on estimation theory. In reality, <em>the number of layers</em> is a redundant parameter since it defines the number of resistivities and thicknesses to be estimated, and therefore its specification is not required as long as the resistivities and thicknesses are correctly specified.</p>
<p>The</p>
<p>In this document, the basic concepts of the stepwise parameter estimation of VES and model selection are introduced and two examples using the rves package are presented.</p>
</div>
<div id="stepwise-estimation-and-model-selection" class="section level1">
<h1 class="hasAnchor">
<a href="#stepwise-estimation-and-model-selection" class="anchor"></a>Stepwise Estimation and Model Selection</h1>
<div id="stepwise-estimation-of-ves-parameters" class="section level2">
<h2 class="hasAnchor">
<a href="#stepwise-estimation-of-ves-parameters" class="anchor"></a>Stepwise Estimation of VES parameters</h2>
<p>The stepwise estimation is a method of estimating model parameters in which the choice of number of parameters and their values are carried out by an automatic procedure. The basic idea is to increase the number of parameters in a stepwise fashion and evaluate the resulting model using a specific criteria such as RMSE, Akaike Information Criteria nad/or Bayesian Information Criteria.</p>
<p>In the specific case of VES, this stepwise estimation is composed of the following steps:</p>
<ul>
<li>From a model of 2 layers to a maximum number of layers, repeat:
<ul>
<li>Define an initial set of values of real resistivities and thicknesses <span class="math inline">\((\rho_{i}^{0},h_{i}^{0})\)</span> where <span class="math inline">\(i=1,\ldots,n\)</span> with <span class="math inline">\(n\)</span> as the current number of layers. The initial resistivities are equal to the mean value of the apparent resistivities: <span class="math display">\[
\rho^{0}=\underbrace{(\bar{\rho}, \bar{\rho}, \ldots, \bar{\rho})}_{n \text{ times}}
\]</span> The initial thicknesses are equal to the first <span class="math inline">\(n-1\)</span> values of <span class="math inline">\(\overline{ab}/2\)</span> transformed to depth using <span class="math inline">\(h_{i}=(\overline{ab}/2)/2.3, i =1,\ldots,n-1\)</span>, and the final value of depth is given by <span class="math inline">\(h_{n}=max(\overline{ab}/2)/2.3\)</span> <span class="math display">\[
h^{0}=(h_{1},\ldots,h_{n})
\]</span>
</li>
<li>Apply an estimation procedure such as NLS or other optimization technique the initial solution</li>
<li>Calculate a model fit measure such as the Residual Sum of Squares, Akaike Information Criterion, Bayesian Information Criterion</li>
</ul>
</li>
<li>Select the best model according to the calculated model fit measure.</li>
</ul>
<p>A similar approach has been proposed by <span class="citation">Muiuane and Pedersen (1999)</span> where the initial solution of a two layer model is defined using the geometric mean of the resistivity values, and the results of the previously estimated model is used as initial solution of the model with the increased number of layers.</p>
</div>
<div id="model-selection-basic-concepts" class="section level2">
<h2 class="hasAnchor">
<a href="#model-selection-basic-concepts" class="anchor"></a>Model Selection: Basic concepts</h2>
<p>The model selection procedure can be defined as the selection a statistical model from a set of candidate models fitted to the same dataset. This situation is very common in geophysics where several models can properly describe the measurements equally well, and therefore it does not make sense to choose a single model as a representation of the subsurface conditions. However, this is the conventional approach where the model that best explain the geophysical measurements is used in the subsequent geological interpretation. Given the importance of this interpretation in the decision making process, it is important to use valid and objective scientific principles in the selection of the statistical model.</p>
<p>The key question of the model selection problem is the objective definition of the <em>the best model</em>. In general this definition is based on the goodness of fit of the estimated model, that is, how close the model explain the observations obtained in the field. This sounds reasonable at the beginning, however, this approach might overfit the model in the sense that a model with a large number of parameters eventually will explain the observations. This problematic situation</p>
<div id="akaike-information-criterion" class="section level3">
<h3 class="hasAnchor">
<a href="#akaike-information-criterion" class="anchor"></a>Akaike Information Criterion</h3>
<p><span class="math display">\[
\text{AIC}=2k-2\log{(\hat{L})}
\]</span></p>
<p>Gaussian distribution error</p>
<p><span class="math display">\[
\log{[\hat{L}(\hat{\rho},\sigma_{e}^{2})]}=\frac{n}{2}\log{(2\pi)}-\frac{n}{2}\log{\sigma_{e}^{2}}-\frac{1}{2\sigma_{e}^{2}}\sum_{i=1}^{n}(\rho_{i}-\hat{\rho}_{i})^{2}
\]</span></p>
</div>
<div id="bayesian-information-criterion" class="section level3">
<h3 class="hasAnchor">
<a href="#bayesian-information-criterion" class="anchor"></a>Bayesian Information Criterion</h3>
<p><span class="math display">\[
\text{BIC}=\log{n}k-2\log{(\hat{L})}
\]</span></p>
<p>Gaussian distribution error</p>
<p><span class="math display">\[
\text{BIC}=n \log{\sigma_{e}^{2}}+k \log{n}
\]</span> <span class="math display">\[
\text{BIC}=n\log{\left( \frac{\text{rss}}{n} \right)} + k\log{n}
\]</span></p>
<p><span class="math display">\[
\text{rss}=\sum_{i}^{n}(\rho_{i} - \hat{\rho}_{i})^{2}
\]</span></p>
</div>
</div>
</div>
<div id="example" class="section level1">
<h1 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h1>
<div id="simple-ves" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-ves" class="anchor"></a>Simple VES</h2>
</div>
<div id="complex-ves" class="section level2">
<h2 class="hasAnchor">
<a href="#complex-ves" class="anchor"></a>Complex VES</h2>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-Muiuane_1999">
<p>Muiuane, E.A, and L.B Pedersen. 1999. “Automatic 1d Interpretation of DC Resistivity Sounding Data.” <em>Journal of Applied Geophysics</em> 42 (1). Elsevier BV: 35–45. doi:<a href="https://doi.org/10.1016/s0926-9851(99)00015-4">10.1016/s0926-9851(99)00015-4</a>.</p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#stepwise-estimation-and-model-selection">Stepwise Estimation and Model Selection</a><ul class="nav nav-pills nav-stacked">
<li><a href="#stepwise-estimation-of-ves-parameters">Stepwise Estimation of VES parameters</a></li>
      <li><a href="#model-selection-basic-concepts">Model Selection: Basic concepts</a></li>
      </ul>
</li>
      <li>
<a href="#example">Example</a><ul class="nav nav-pills nav-stacked">
<li><a href="#simple-ves">Simple VES</a></li>
      <li><a href="#complex-ves">Complex VES</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Oscar Garcia-Cabrejo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
