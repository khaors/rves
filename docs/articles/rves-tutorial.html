<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>RVES Tutorial: Vertical Electrical Sounding interpretation using R • rves</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">rves</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/rves-tutorial.html">RVES Tutorial: Vertical Electrical Sounding interpretation using R</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>RVES Tutorial: Vertical Electrical Sounding interpretation using R</h1>
                        <h4 class="author">Oscar Garcia-Cabrejo</h4>
            
            <h4 class="date">2017-12-17</h4>
          </div>

    
    
<div class="contents">
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Importance of subsurface investigations. Specially for groundwater.</p>
<p>The Vertical Electrical Sounding (VES) is one of the oldest resistivity methods, and it is based on the measurements of the electrical apparent resistivity of the geological medium when the distance between the electrical source and the measurement nodes is increased. The main advantages of the VES include:</p>
<ul>
<li>low cost due to its minimal requirements for equipment and personal.</li>
<li>large investigation depth as required in some specific problems such as groundwater exploration.</li>
</ul>
<p>From the information usually acquired during a VES (apparent resisitivities vs electrode spacing), the true resistivities and thicknesses of the layers present in the subsurface are estimated, which in turns can help to the Geophysicist in the definition of a simple layered geological model of the area. When several VES are located along a given section, then the lateral variations of the layers can be interpreted yielding to an improved description of the geological structure.</p>
</div>
<div id="methodology" class="section level1">
<h1 class="hasAnchor">
<a href="#methodology" class="anchor"></a>Methodology</h1>
<div id="ves-basic-concepts" class="section level2">
<h2 class="hasAnchor">
<a href="#ves-basic-concepts" class="anchor"></a>VES: Basic Concepts</h2>
<p>Let <span class="math inline">\(A,B\)</span> be the current electrodes (positive and negative respectively) located on the ground surface and <span class="math inline">\(M,N\)</span> are the sensors used to measure the potential. The apparent resistivity of an Earth material is defined as:</p>
<p><span class="math display">\[
\rho_{app,k} = k \frac{U_{MN}}{I_{AB}}
\]</span> where <span class="math inline">\(k\)</span> is the so called geometric factor of the electrode array, <span class="math inline">\(U_{MN}\)</span> is the voltage between the electrodes <span class="math inline">\(M\)</span> and <span class="math inline">\(N\)</span> and <span class="math inline">\(I_{AB}\)</span> is the electric current applied between the measurement electrodes <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
<p>The geometric factor of the array is defined as: <span class="math display">\[
k=\frac{2 \pi}{\frac{1}{r_{AM}} - \frac{1}{r_{BM}} - \frac{1}{r_{AN}} + \frac{1}{r_{BN}} }
\]</span> where <span class="math inline">\(r\)</span> is the distance between the electrodes.</p>
<p>The values of the apparent resistivity <span class="math inline">\(\rho_{app,k}\)</span> change as the electrode separation <span class="math inline">\(AB/2\)</span> is increased.</p>
</div>
<div id="forward-model" class="section level2">
<h2 class="hasAnchor">
<a href="#forward-model" class="anchor"></a>Forward Model</h2>
<p>An essential part of the estimation of the real resistivitis and thicknesses of the layer in the area where the VES was obtained is the ability to calculate the apparent resistivity values from the knowledge of the number of layers, their true resistities and thicknesses. These parameters can be estimated matching the apparent resistivity curve to the measured apparent resistivities. The most efficient procedure to calculate this apparent resistivity curve is the methodology of the linear filter originally proposed by Gosh(1971) . This approach is divided in two stages:</p>
<ul>
<li>Resistivity Transform Calculation</li>
</ul>
<p>The electric potential of a horizontally layered Earth is given by:</p>
<p><span class="math display">\[
U(x)=\frac{I \rho_{1}}{2 \pi} \frac{1}{x} \left( 1 + 2x \int_{0}^{+\infty} K(\lambda) J_{0}(\lambda x)d\lambda \right)
\]</span> where <span class="math inline">\(\rho_{1}\)</span> is the resistivity of the first layer, <span class="math inline">\(J_{0}\)</span> is the Bessel function of order zero , and <span class="math inline">\(K(\lambda)\)</span> is the Kernel function that depends on <span class="math inline">\(\lambda\)</span> and the resisitivities and thicknesses of all layers and the resistivity of the substratum. The previous equation can be simplied to: <span class="math display">\[
U(x)=\frac{I \rho_{1}}{2 \pi} \int\limits_{0}^{\infty} T(\lambda) J_{0}(\lambda x) d\lambda
\]</span> where <span class="math inline">\(T(\lambda)\)</span> is called the resistivity transform which is defined as: <span class="math display">\[
T(\lambda)=\rho_{1}\left(I+2K(\lambda)\right)
\]</span></p>
<ul>
<li>Apparent Resistivity Calculation</li>
</ul>
<p>The apparent resistivity of a Sclumberger array can be obtained from the Ohm’s Law and the expression of the electric potential showed in the previous section: <span class="math display">\[
\rho_{\text{app}}(x)=-\frac{2\pi}{I}x^{2} \left( \frac{\partial U}{\partial r} \right)
\]</span> which can be expressed as: <span class="math display">\[
\rho_{\text{app}}(x)=x^{2}\int\limits_{0}^{\infty}T(\lambda)J_{1}(\lambda x) \lambda d\lambda
\]</span> where <span class="math inline">\(T(\lambda)\)</span> is the resistivity transform, <span class="math inline">\(J_{1}(\lambda x)\)</span> is the Bessel function of order 1.</p>
<p>An expression of the resistivity transform <span class="math inline">\(T(\lambda)\)</span> is given by: <span class="math display">\[
T(\lambda)=\int\limits_{0}^{\infty} \left[ \rho_{\text{app}}(x) J_{1}(\lambda x)/x \right]dx
\]</span> which can be obtained by applying the Hankel’s inversion of the Fourier-Bessel integral of the apparent resistivity function for a Schlumberger array. Using the following variables: <span class="math display">\[
\begin{aligned}
s&amp;=\log{x}\\
r&amp;=\log{(1/\lambda)}
\end{aligned}
\]</span> then the expression of the resistivity tranform is given by: <span class="math display">\[
T(r)=\int\limits_{-\infty}^{+\infty}\rho_{\text{app}}(s)J_{1}(1/\exp{(r-s)})ds
\]</span> which is a convolution integral that can be easily solved in the frequency domain: <span class="math display">\[
T(\omega)=G(\omega) H(\omega)
\]</span> where <span class="math inline">\(T(\omega)\)</span> is the Fourier transform of the resistivity transform, <span class="math inline">\(G(\omega)=\mathcal{F}(\rho_{\text{app}}(x))\)</span> is the Fourier transform of the apparent resistivity data, and <span class="math inline">\(H(\omega)=\mathcal{F}(J_{1}(1/\exp{(x)}))\)</span> is the Fourier transform of the Bessel function of order 1. In the Geophysics literature, this Fourier transform is called the Transform of the linear filter. This filter can be obtained from the ratio of the Fourier transform of <span class="math inline">\(T(\lambda)\)</span> and the Fourier transform of the <span class="math inline">\(\rho_{\text{app}}(x)\)</span></p>
</div>
<div id="parameter-estimation" class="section level2">
<h2 class="hasAnchor">
<a href="#parameter-estimation" class="anchor"></a>Parameter Estimation</h2>
</div>
</div>
<div id="examples" class="section level1">
<h1 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h1>
<div id="ves-1" class="section level2">
<h2 class="hasAnchor">
<a href="#ves-1" class="anchor"></a>VES 1</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(rves)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">data</span>(<span class="st">"ves_data1"</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">ab2 &lt;-<span class="st"> </span>ves_data1<span class="op">$</span>ab2
apprho &lt;-<span class="st"> </span>ves_data1<span class="op">$</span>apprho
sev1a &lt;-<span class="st"> </span><span class="kw"><a href="../reference/ves.html">ves</a></span>(<span class="dt">id=</span> <span class="st">"Sounding 1"</span>, <span class="dt">ab2 =</span> ab2, <span class="dt">apprho =</span> apprho)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p1 &lt;-<span class="st"> </span><span class="kw">plot</span>(sev1a)</code></pre></div>
<p><img src="rves-tutorial_files/figure-html/plot_sev1a-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rho &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">40</span>,<span class="dv">70</span>,<span class="dv">30</span>, <span class="dv">20</span>)
thick &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">50</span>,<span class="dv">500</span>)
sev1a<span class="op">$</span>rhopar &lt;-<span class="st"> </span>rho
sev1a<span class="op">$</span>thickpar &lt;-<span class="st"> </span>thick
sev1a<span class="op">$</span>interpreted &lt;-<span class="st"> </span><span class="ot">TRUE</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2 &lt;-<span class="st"> </span><span class="kw">plot</span>(sev1a)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res &lt;-<span class="st"> </span><span class="kw"><a href="../reference/apparent_resistivities.html">apparent_resistivities</a></span>(rho, thick, <span class="dt">filt=</span>filt<span class="op">$</span>V1, ab2)
<span class="kw">print</span>(res<span class="op">$</span>appres)
<span class="co">#&gt;  [1] 45.03442 50.79032 55.28891 57.89512 57.49175 54.80907 50.75936</span>
<span class="co">#&gt;  [8] 46.97001 41.22785 36.61319 34.31048 30.31195 28.43154 26.55114</span>
<span class="co">#&gt; [15] 25.11512 22.97268 22.21597 21.45926</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">rerr &lt;-<span class="st"> </span><span class="dv">100</span><span class="op">*</span><span class="kw">abs</span>(res<span class="op">$</span>appres<span class="op">-</span>apprho)<span class="op">/</span>res<span class="op">$</span>appres
<span class="kw">print</span>(rerr)
<span class="co">#&gt;  [1]  7.095863  1.201653  4.085640  9.594723  7.111025 11.952279 14.757161</span>
<span class="co">#&gt;  [8] 26.399793 18.124039  1.265088 10.960138 11.025177 23.254249 13.939657</span>
<span class="co">#&gt; [15] 12.244097  6.279988  4.032997 10.528123</span>
<span class="kw">print</span>(<span class="kw">mean</span>(rerr))
<span class="co">#&gt; [1] 10.76954</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">par0 &lt;-<span class="st"> </span><span class="kw">c</span>(rho, thick)
res.nls &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calibrate_nls.html">calibrate_nls</a></span>(sev1a, par0, <span class="dt">iterations =</span> <span class="dv">10</span>, <span class="dt">ireport =</span> <span class="dv">5</span>)
<span class="co">#&gt; iteration, RSS, Rel Error =  0 17.92395 10.10434 </span>
<span class="co">#&gt; iteration, RSS, Rel Error =  5 4.657908 4.95162 </span>
<span class="co">#&gt; iteration, RSS, Rel Error =  9 3.95511 4.878283</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sev1a<span class="op">$</span>rhopar &lt;-<span class="st"> </span>res.nls<span class="op">$</span>rho
sev1a<span class="op">$</span>thickpar &lt;-<span class="st"> </span>res.nls<span class="op">$</span>thickness
sev1a<span class="op">$</span>interpreted &lt;-<span class="st"> </span><span class="ot">TRUE</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p1 &lt;-<span class="st"> </span><span class="kw">plot</span>(sev1a, <span class="dt">main =</span> <span class="st">"Nonlinear Least Squares"</span>)
<span class="kw">print</span>(p1)</code></pre></div>
<p><img src="rves-tutorial_files/figure-html/plot_earth_model_nls-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">res.lbfgs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calibrate.html">calibrate</a></span>(sev1a, <span class="dt">opt.method =</span> <span class="st">"L-BFGS-B"</span>, <span class="dt">obj.fn =</span> <span class="st">"rss"</span>, 
                       <span class="dt">par0 =</span> par0, <span class="dt">lower =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">4</span>), <span class="kw">rep</span>(<span class="dv">5</span>,<span class="dv">4</span>)), 
                       <span class="dt">upper =</span> <span class="kw">c</span>(<span class="kw">rep</span>(<span class="dv">100</span>,<span class="dv">4</span>),<span class="kw">rep</span>(<span class="dv">501</span>,<span class="dv">4</span>)))</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sev1a<span class="op">$</span>rhopar &lt;-<span class="st"> </span>res.lbfgs<span class="op">$</span>rho
sev1a<span class="op">$</span>thickpar &lt;-<span class="st"> </span>res.lbfgs<span class="op">$</span>thickness
sev1a<span class="op">$</span>interpreted &lt;-<span class="st"> </span><span class="ot">TRUE</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">p2 &lt;-<span class="st"> </span><span class="kw">plot</span>(sev1a, <span class="dt">main =</span> <span class="st">"L-BFGS-B"</span>)
<span class="kw">print</span>(p2)</code></pre></div>
<p><img src="rves-tutorial_files/figure-html/plot_earth_model_lbfgsb-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li>
<a href="#methodology">Methodology</a><ul class="nav nav-pills nav-stacked">
<li><a href="#ves-basic-concepts">VES: Basic Concepts</a></li>
      <li><a href="#forward-model">Forward Model</a></li>
      <li><a href="#parameter-estimation">Parameter Estimation</a></li>
      </ul>
</li>
      <li>
<a href="#examples">Examples</a><ul class="nav nav-pills nav-stacked">
<li><a href="#ves-1">VES 1</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Oscar Garcia-Cabrejo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
